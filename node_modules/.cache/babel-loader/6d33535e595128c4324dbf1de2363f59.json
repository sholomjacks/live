{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"C:\\\\Users\\\\gamem\\\\codecademy\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"C:\\\\Users\\\\gamem\\\\codecademy\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"C:\\\\Users\\\\gamem\\\\codecademy\\\\node_modules\\\\@babel\\\\runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"C:\\\\Users\\\\gamem\\\\codecademy\\\\node_modules\\\\@babel\\\\runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"C:\\\\Users\\\\gamem\\\\codecademy\\\\node_modules\\\\@babel\\\\runtime/helpers/inherits\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar stream_1 = require(\"stream\");\n/**\n * Convenient class to convert the process of scaning keys to a readable stream.\n *\n * @export\n * @class ScanStream\n * @extends {Readable}\n */\n\n\nvar ScanStream =\n/*#__PURE__*/\nfunction (_stream_1$Readable) {\n  _inherits(ScanStream, _stream_1$Readable);\n\n  function ScanStream(opt) {\n    var _this;\n\n    _classCallCheck(this, ScanStream);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ScanStream).call(this, opt));\n    _this.opt = opt;\n    _this._redisCursor = \"0\";\n    _this._redisDrained = false;\n    return _this;\n  }\n\n  _createClass(ScanStream, [{\n    key: \"_read\",\n    value: function _read() {\n      var _this2 = this;\n\n      if (this._redisDrained) {\n        this.push(null);\n        return;\n      }\n\n      var args = [this._redisCursor];\n\n      if (this.opt.key) {\n        args.unshift(this.opt.key);\n      }\n\n      if (this.opt.match) {\n        args.push(\"MATCH\", this.opt.match);\n      }\n\n      if (this.opt.count) {\n        args.push(\"COUNT\", String(this.opt.count));\n      }\n\n      this.opt.redis[this.opt.command](args, function (err, res) {\n        if (err) {\n          _this2.emit(\"error\", err);\n\n          return;\n        }\n\n        _this2._redisCursor = res[0] instanceof Buffer ? res[0].toString() : res[0];\n\n        if (_this2._redisCursor === \"0\") {\n          _this2._redisDrained = true;\n        }\n\n        _this2.push(res[1]);\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      this._redisDrained = true;\n    }\n  }]);\n\n  return ScanStream;\n}(stream_1.Readable);\n\nexports.default = ScanStream;","map":{"version":3,"sources":["C:/Users/gamem/codecademy/node_modules/ioredis/built/ScanStream.js"],"names":["Object","defineProperty","exports","value","stream_1","require","ScanStream","opt","_redisCursor","_redisDrained","push","args","key","unshift","match","count","String","redis","command","err","res","emit","Buffer","toString","Readable","default"],"mappings":"AAAA;;;;;;;;;;;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;;AACA,IAAMC,QAAQ,GAAGC,OAAO,CAAC,QAAD,CAAxB;AACA;;;;;;;;;IAOMC,U;;;;;AACF,sBAAYC,GAAZ,EAAiB;AAAA;;AAAA;;AACb,oFAAMA,GAAN;AACA,UAAKA,GAAL,GAAWA,GAAX;AACA,UAAKC,YAAL,GAAoB,GAApB;AACA,UAAKC,aAAL,GAAqB,KAArB;AAJa;AAKhB;;;;4BACO;AAAA;;AACJ,UAAI,KAAKA,aAAT,EAAwB;AACpB,aAAKC,IAAL,CAAU,IAAV;AACA;AACH;;AACD,UAAMC,IAAI,GAAG,CAAC,KAAKH,YAAN,CAAb;;AACA,UAAI,KAAKD,GAAL,CAASK,GAAb,EAAkB;AACdD,QAAAA,IAAI,CAACE,OAAL,CAAa,KAAKN,GAAL,CAASK,GAAtB;AACH;;AACD,UAAI,KAAKL,GAAL,CAASO,KAAb,EAAoB;AAChBH,QAAAA,IAAI,CAACD,IAAL,CAAU,OAAV,EAAmB,KAAKH,GAAL,CAASO,KAA5B;AACH;;AACD,UAAI,KAAKP,GAAL,CAASQ,KAAb,EAAoB;AAChBJ,QAAAA,IAAI,CAACD,IAAL,CAAU,OAAV,EAAmBM,MAAM,CAAC,KAAKT,GAAL,CAASQ,KAAV,CAAzB;AACH;;AACD,WAAKR,GAAL,CAASU,KAAT,CAAe,KAAKV,GAAL,CAASW,OAAxB,EAAiCP,IAAjC,EAAuC,UAACQ,GAAD,EAAMC,GAAN,EAAc;AACjD,YAAID,GAAJ,EAAS;AACL,UAAA,MAAI,CAACE,IAAL,CAAU,OAAV,EAAmBF,GAAnB;;AACA;AACH;;AACD,QAAA,MAAI,CAACX,YAAL,GAAoBY,GAAG,CAAC,CAAD,CAAH,YAAkBE,MAAlB,GAA2BF,GAAG,CAAC,CAAD,CAAH,CAAOG,QAAP,EAA3B,GAA+CH,GAAG,CAAC,CAAD,CAAtE;;AACA,YAAI,MAAI,CAACZ,YAAL,KAAsB,GAA1B,EAA+B;AAC3B,UAAA,MAAI,CAACC,aAAL,GAAqB,IAArB;AACH;;AACD,QAAA,MAAI,CAACC,IAAL,CAAUU,GAAG,CAAC,CAAD,CAAb;AACH,OAVD;AAWH;;;4BACO;AACJ,WAAKX,aAAL,GAAqB,IAArB;AACH;;;;EApCoBL,QAAQ,CAACoB,Q;;AAsClCtB,OAAO,CAACuB,OAAR,GAAkBnB,UAAlB","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst stream_1 = require(\"stream\");\n/**\n * Convenient class to convert the process of scaning keys to a readable stream.\n *\n * @export\n * @class ScanStream\n * @extends {Readable}\n */\nclass ScanStream extends stream_1.Readable {\n    constructor(opt) {\n        super(opt);\n        this.opt = opt;\n        this._redisCursor = \"0\";\n        this._redisDrained = false;\n    }\n    _read() {\n        if (this._redisDrained) {\n            this.push(null);\n            return;\n        }\n        const args = [this._redisCursor];\n        if (this.opt.key) {\n            args.unshift(this.opt.key);\n        }\n        if (this.opt.match) {\n            args.push(\"MATCH\", this.opt.match);\n        }\n        if (this.opt.count) {\n            args.push(\"COUNT\", String(this.opt.count));\n        }\n        this.opt.redis[this.opt.command](args, (err, res) => {\n            if (err) {\n                this.emit(\"error\", err);\n                return;\n            }\n            this._redisCursor = res[0] instanceof Buffer ? res[0].toString() : res[0];\n            if (this._redisCursor === \"0\") {\n                this._redisDrained = true;\n            }\n            this.push(res[1]);\n        });\n    }\n    close() {\n        this._redisDrained = true;\n    }\n}\nexports.default = ScanStream;\n"]},"metadata":{},"sourceType":"script"}